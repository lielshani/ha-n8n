---
name: "n8n"
version: "1.0.11"
slug: "ha_n8n"
description: "Self-hosted n8n workflow automation for Home Assistant"
url: "https://github.com/lielshani/ha-n8n"

# ---------------------------------------------------------------------------
# Architecture & Lifecycle
# ---------------------------------------------------------------------------
arch:
  - aarch64
  - amd64
init: false
startup: application
boot: auto

# ---------------------------------------------------------------------------
# Ingress (authenticated UI access via HA panel)
# ---------------------------------------------------------------------------
ingress: true
ingress_port: 5678
ingress_stream: true
panel_icon: "mdi:sitemap-outline"

# ---------------------------------------------------------------------------
# HA Integration
# ---------------------------------------------------------------------------
homeassistant_api: true
hassio_api: true
hassio_role: "default"

# ---------------------------------------------------------------------------
# Volume Mappings  (/data is always mapped & writable by default)
# ---------------------------------------------------------------------------
map:
  - ssl:ro
  - share:rw
  - media:rw

# ---------------------------------------------------------------------------
# Network Ports
# ---------------------------------------------------------------------------
ports:
  5680/tcp: 5678
ports_description:
  5680/tcp: >-
    n8n direct access (LAN). Access n8n at http://<your-ha-ip>:5678/.
    This bypasses HA ingress and works from any device on your local
    network. Also required for external webhooks. Change or disable
    in the add-on Network configuration.

# ---------------------------------------------------------------------------
# Health Monitoring (Supervisor watchdog)
# ---------------------------------------------------------------------------
watchdog: "http://[HOST]:5680/"

# ---------------------------------------------------------------------------
# Backup
# ---------------------------------------------------------------------------
backup_exclude:
  - "*.log"
  - ".n8n/crash.journal"
  - ".n8n/.cache"

# ---------------------------------------------------------------------------
# User Options & Schema
# ---------------------------------------------------------------------------
options:
  env_vars_list: []
schema:
  timezone: "str?"
  env_vars_list:
    - "match(^[A-Z_0-9]+: .*$)"
  cmd_line_args: "str?"
